#import "../conf.typ": *

= О предсказании следующего бита

#definition[
  Семейство случайных величин ${xi_n}_(n in NN)$ удовлетворяет условию *непредсказуемости следующего бита*, если для любой п.в.м.Т. $P$:
  #eq[
    $mu_(i in_cal(U) {1, ..., m(n)}) ({P(1^n; xi_n^[1, ..., i - 1]) = xi_n^[i]}) <= 1 / 2 + negl(n)$
  ]
]

#theorem("Яо об эквивалентности")[
  Семейство случайных величин ${xi_n}_(n in NN)$ псевдослучайно тогда и только тогда, когда ${xi_n}_(n in NN)$ удовлетворяет условию непредсказуемости следующего бита.
]

#proof[
  $=>$ От обратного, пусть существует п.в.м.Т. $P$ "предсказатель" и полином $p$:
  #eq[
    $mu_i ({P(1^n; xi_n^[1, ..., i- 1]) = xi_n^[i]}) > 1 / 2 + 1 / p(n)$
  ]
  Построим "различитель" - п.в.м.Т. $D$, работающую на входах $(1^n; x), x in BB^(m(n))$, работающий по алгоритму:
  + Выбираем случайный $i in_cal(U) {1, ..., m(n)}$
  + Если "предсказатель" угадал по $x^[1, ..., i - 1]$ битам $i$-й, то "различитель" возвращает 1, иначе 0.
  Рассмотрим вероятность:
  - $mu({D(1^n; xi_n) = 1}) = mu_i ({P(1^n; xi_n^[1, ..., i-1]) = xi_n^[i]}) > 1 / 2 + 1 / p(n)$
  - $mu({D(1^n; v_m(n)) = 1}) = \ mu({P(1^n; v_m(n)^[1, ..., i - 1]) = v_m(n)^[i]}) = \
      sum_(k = 1)^(m(n)) mu({P(1^n; v_m(n)^[1, ..., k - 1]) = v_m(n)^[k], i = k}) = \
      sum_(k = 1)^(m(n)) mu({P(1^n; v_m(n)^[1, ..., k - 1]) = v_m(n)^[k]}) mu({i = k}) = m(n) dot 1 / 2 dot 1 / m(
        n
      ) = 1 / 2$
  Разность этих вероятностей $> 1 / p(n)$ для бесконечно многих $n$ -- противоречие.
  $arrow.double.l$ От противного. Предположим, ${xi_n}_(n in NN)$ и ${v_m(n)}_(n in NN)$ не вычислимо неразличимы: существует такая п.в.м.Т. $D$ "различитель" и полином $p$, что для бесконечно многих $n$:
  #eq[
    $abs(mu({D(1^n; xi_n) = 1}) - mu({D(1^n; v_m(n)) = 1})) > 1 / p(n)$
  ]
  Построим "предсказатель следующего бита" -- п.в.м.Т. $P$, работающую на входах $(1^n; x), x in BB^(< m(n))$, следующим образом:
  + Выбираем случайный $y in_cal(U) BB^(m(n) - abs(x))$
  + Если "различитель" на входе $x times y$ выдал 1, то возвращаем $y^[1]$, иначе $not y^[1]$.
  Обозначим $sigma_i (n) = mu({D(1^n; xi_n^[1, ..., i] times v_m(n)^[i + 1, ..., m(n)]) = 1}); 0 <= i <= m(n)$
  Тогда рассмотрим цепочку равенств:
  #eq[
    $mu({P(1^n; xi_n^[1, ..., i - 1]) = xi_n^[i]}) = \
      mu({P(1^n; xi_n^[1, ..., i - 1]) = xi_n^[i], v_m(n)^[i] = xi_n^[i]}) + mu({P(1^n; xi_n^[1, ..., i - 1]) = xi_n^[i], v_m(n)^[i] = not xi_n^[i]}) = \
      mu({P(1^n; xi_n^[1, ..., i - 1]) = v_m(n)^[i], v_m(n)^[i] = xi_n^[i]}) + mu({P(1^n; xi_n^[1, ..., i - 1]) = not v_m(n)^[i] , v_m(n)^[i] = not xi_n^[i]}) = \
      mu({D(1^n; xi_n^[1, ..., i - 1] times v_m(n)^[i, ..., m(n)]) = 1, v_m(n)^[i] = xi_n^[i]}) + mu({D(1^n; xi_n^[1, ..., i - 1] times v_m(n)^[i, ..., m(n)]) = 0 , v_m(n)^[i] = not xi_n^[i]}) = \
      sum_(b in BB)mu({D(1^n; xi_n^[1, ..., i - 1] times b times v_m(n)^[i + 1, ..., m(n)]) = 1, v_m(n)^[i] = b, b = xi_n^[i]}) + \
      sum_(b in BB)mu({D(1^n; xi_n^[1, ..., i - 1] times b times v_m(n)^[i + 1, ..., m(n)]) = 0, v_m(n)^[i] = b, b = not xi_n^[i]}) = \
      1 / 2 mu({D(1^n; xi_n^[1, ..., i] times v_m(n)^[i + 1, ..., m(n)]) = 1}) + 1 / 2 mu({D(1^n; xi_n^[1, ..., i - 1] times not xi_n^[i] times v_m(n)^[i + 1, ..., m(n)]) = 0}) = \
      1 / 2 sigma_i (n) + 1 / 2 (1 - 2 sigma_(i - 1) (n) + sigma_i (n)) = 1 / 2 + sigma_i (n) - sigma_(i - 1) (n)$
  ]
  Где в последнем переходе используется равенство:
  #eq[
    $mu({D(1^n, xi_n^[1, ..., i - 1] times not xi_n^[i] times v_m(n)^[i + 1, ..., m(n)]) = 1}) = 2 sigma_(i - 1) (
        n
      ) - sigma_i (n)$
  ]
  которое получается аналогичным расписываниям выше, но для предсказания $i - 1$ бита.

  В итоге
  #eq[
    $mu({P(1^n; xi_n^[1, ..., i - 1]) = xi_n^[i]}) = 1 / m(n) sum_(k = 1)^m(
        n
      ) mu({P(1^n; xi_n^[1, ..., k - 1]) = xi_n^[k]}) = \
      1 / 2 + 1 / m(n) sum_(k = 1)^m(n) (sigma_k (n) - sigma_(k - 1) (n)) = \
      1 / 2 + 1 / m(n) (mu({D(1^n; xi_n) = 1}) - mu({D(1^n; v_m(n)) = 1})) > 1 / 2 + 1 / (m(n) p(n))$
  ]
  Что для бесконечно многих $n$ даёт противоречие с условием непредсказуемости следующего бита.
]
